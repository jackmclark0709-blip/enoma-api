<!DOCTYPE html>
<html>
<head>
  <title>Enoma — Your Public Identity</title>
  <style>
    body {
      font-family: system-ui;
      padding: 60px;
      background: #0b0b0d;
      color: white;
    }
    a { color: #7b61ff }
  </style>
</head>
<body></body>

<script>
const slug = location.pathname.replace("/", "").replace(".html", "");

const knownPages = ["", "index", "create", "profile"];

if (knownPages.includes(slug)) {
  document.body.innerHTML = `
    <h1>Enoma</h1>
    <p>Your professional identity, generated and maintained.</p>
    <a href="/create.html">Create your profile →</a>
  `;
} else {
  fetch(`/api/get-profile?username=${slug}`)
    .then(res => {
      if (!res.ok) throw new Error("Not found");
      return res.json();
    })
    .then(profile => {
      renderProfile(profile);
    })
    .catch(() => {
      document.body.innerHTML = `
        <h1>Profile not found</h1>
        <p>No public profile exists for "${slug}".</p>
        <a href="/create.html">Create yours →</a>
      `;
    });
}

function renderProfile(profile) {
  document.body.innerHTML = `
    <h1>${profile.display_name}</h1>
    <h3>${profile.headline}</h3>
    <p>${profile.summary}</p>

    ${
      profile.expertise?.length ? `
      <h4>Expertise</h4>
      <ul>${profile.expertise.map(e => `<li>${e}</li>`).join("")}</ul>`
      : ""
    }

    ${
      profile.timeline?.length ? `
      <h4>Timeline</h4>
      <ul>${profile.timeline.map(e => `<li>${e.year} — ${e.event}</li>`).join("")}</ul>`
      : ""
    }

    ${
      profile.links ? `
      <h4>Links</h4>
      <ul><li><a href="${profile.links.url}" target="_blank">${profile.links.label}</a></li></ul>`
      : ""
    }
  `;
}
</script>


</html>
