<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title id="seo_title">Business — Enoma</title>
  <meta id="seo_description" name="description" content="">

  <style>
    :root {
      --blue: #211551;
      --lavender: #9A8CFF;
      --green: #50A684;
      --bg: #f6f7f9;
      --text: #1c1c1c;
    }

    body {
      font-family: "Inter", system-ui, sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--text);
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 2rem 1.25rem;
    }

    /* HERO SECTION */
    .hero {
      text-align: center;
      padding: 3.5rem 1.5rem;
      background: linear-gradient(135deg, var(--lavender), var(--blue));
      color: white;
      border-radius: 18px;
      margin-top: 2rem;
    }

    .hero h1 {
      font-size: 2.4rem;
      font-weight: 700;
      margin: 0;
    }

    .hero p {
      font-size: 1.25rem;
      opacity: 0.9;
      margin-top: 0.5rem;
    }

    /* SECTION WRAPPER */
    .section {
      background: white;
      border-radius: 14px;
      padding: 2rem;
      margin-top: 2rem;
      box-shadow: 0 8px 25px rgba(0,0,0,0.06);
    }

    .section h2 {
      margin-top: 0;
      font-size: 1.3rem;
      color: var(--blue);
    }

    /* SERVICES GRID */
    .service-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 1.25rem;
      margin-top: 1rem;
    }

    .service-card {
      background: #fafafa;
      padding: 1rem 1.2rem;
      border-radius: 12px;
      border: 1px solid #eee;
    }

    .service-card h3 {
      margin: 0 0 0.35rem;
      color: var(--blue);
      font-size: 1.05rem;
    }

    /* LOCAL SEO TOWN SECTIONS */
    .town-section {
      margin-top: 1.25rem;
      padding: 1.25rem;
      background: #f8f8ff;
      border-left: 4px solid var(--lavender);
      border-radius: 10px;
    }

    /* CONTACT BOX */
    .contact-box {
      background: #f0f8f4;
      border-left: 4px solid var(--green);
      padding: 1.25rem;
      border-radius: 10px;
      margin-top: 1.5rem;
    }

    .footer {
      text-align: center;
      margin-top: 4rem;
      opacity: 0.5;
      font-size: 0.8rem;
    }
  </style>
</head>

<body>

<div class="container">
  
  <!-- HERO -->
  <div class="hero">
    <h1 id="businessName"></h1>
    <p id="heroTagline"></p>
  </div>

  <!-- ABOUT -->
  <div class="section">
    <h2>About Us</h2>
    <p id="about"></p>
  </div>

  <!-- WHY CHOOSE US -->
  <div class="section">
    <h2>Why Choose Us</h2>
    <div id="why"></div>
  </div>

  <!-- SERVICES -->
  <div class="section">
    <h2>Services We Provide</h2>
    <div id="services" class="service-grid"></div>
  </div>

  <!-- SERVICE AREA -->
  <div class="section">
    <h2>Service Area</h2>
    <p id="serviceArea"></p>
  </div>

  <!-- TOWN SEO SECTIONS -->
  <div class="section">
    <h2>Serving Your Community</h2>
    <div id="townSections"></div>
  </div>

  <!-- CONTACT -->
  <div class="section contact-box">
    <h2>Contact Us</h2>
    <p><strong>Email:</strong> <span id="email"></span></p>
    <p><strong>Phone:</strong> <span id="phone"></span></p>
    <p><strong>Website:</strong> <a id="website" href="" target="_blank"></a></p>
    <p><strong>Address:</strong> <span id="address"></span></p>
  </div>

  <div class="footer">
    Powered by Enoma — Smart Web Presence for Local Businesses
  </div>

</div>

<script>
async function loadBusiness() {
  const urlParams = new URLSearchParams(location.search);
  const slug = urlParams.get("slug");

  if (!slug) {
    document.body.innerHTML = "<h2>Business not found.</h2>";
    return;
  }

  const res = await fetch(`/api/get-business?username=${slug}`);
  const p = await res.json();

  // SEO
  document.getElementById("seo_title").textContent = p.seo_title || p.business_name;
  document.getElementById("seo_description").content = p.seo_description || "";

  // Hero
  document.getElementById("businessName").textContent = p.business_name;
  document.getElementById("heroTagline").textContent = p.hero_tagline;

  // About
  document.getElementById("about").textContent = p.about;

  // Why Choose Us
  document.getElementById("why").innerHTML = p.why_choose_us
    ? `<ul>${p.why_choose_us.split("\n").map(x => `<li>${x}</li>`).join("")}</ul>`
    : "";

  // Services
  const servicesEl = document.getElementById("services");
  servicesEl.innerHTML = "";
  (p.services || []).forEach(s => {
    servicesEl.innerHTML += `
      <div class="service-card">
        <h3>${s.name}</h3>
        <p>${s.description}</p>
      </div>`;
  });

  // Service area
  document.getElementById("serviceArea").textContent = (p.service_area || []).join(", ");

  // Town Sections
  const townEl = document.getElementById("townSections");
  townEl.innerHTML = "";
  (p.town_sections || []).forEach(t => {
    townEl.innerHTML += `
      <div class="town-section">
        <h3>${t.town}</h3>
        <p>${t.text}</p>
      </div>`;
  });

  // Contact
  document.getElementById("email").textContent = p.email;
  document.getElementById("phone").textContent = p.phone;
  document.getElementById("address").textContent = p.address;
  document.getElementById("website").textContent = p.website;
  document.getElementById("website").href = p.website;
}

loadBusiness();
</script>

</body>
</html>
